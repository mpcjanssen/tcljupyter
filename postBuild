export REPO=`pwd`
echo `pwd`
echo $CONDA_DIR
export PREFIX=${CONDA_DIR}/envs/notebook

cd ${PREFIX}
mkdir -p src
cd src
export TCLLIBPATH=$PREFIX

git clone https://github.com/RubyLane/rl_json.git
cd rl_json
./configure --prefix=$PREFIX
make && make install
git clone https://github.com/tcltk/tcllib
cd tcllib
./configure --prefix=$PREFIX
make && make install
cd ..
git clone https://github.com/andreas-kupries/critcl
cd critcl
tclsh build.tcl install
cd ..
git clone https://github.com/jdc8/tclzmq
cd tclzmq
tclsh build.tcl install $PREFIX -zmq ${PREFIX}
cd ..
tclsh $REPO/testdeps.tcl
export KERNELPATH=$PREFIX/share/jupyter/kernels/tcljupyter
mkdir -p $KERNELPATH

cp $REPO/kernel.json.binder $KERNELPATH/kernel.json
cp $REPO/init.tcl $KERNELPATH/
cp -R $REPO/modules $KERNELPATH/

